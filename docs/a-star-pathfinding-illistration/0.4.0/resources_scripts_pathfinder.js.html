<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>resources/scripts/pathfinder.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Area.html">Area</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area.html#.assumFromTwoDArray">assumFromTwoDArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area.html#contains">contains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area.html#iterator">iterator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area.html#toString">toString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="AreaGroup.html">AreaGroup</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="AreaGroup.html#contains">contains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="AreaGroup.html#iterator">iterator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="AreaGroup.html#toString">toString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Area-AreaIterator.html">AreaIterator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area-AreaIterator.html#forEach">forEach</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area-AreaIterator.html#hasNext">hasNext</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Area-AreaIterator.html#next">next</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Cell.html">Cell</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cell.html#getPathOfCell">getPathOfCell</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cell.html#registerDisplayElementForCell">registerDisplayElementForCell</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EventManager.html">EventManager</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventManager.html#addEventListener">addEventListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventManager.html#dispatchEvent">dispatchEvent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventManager.html#removeEventListener">removeEventListener</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Grid.html">Grid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Grid.html#appendPossibleCells">appendPossibleCells</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Grid.html#calcHCell">calcHCell</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Grid.html#getSorrundingCells">getSorrundingCells</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Grid.html#resetPathfinding">resetPathfinding</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Grid.html#step">step</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PathfinderVisualization.html">PathfinderVisualization</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PathfinderVisualization.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PathfinderVisualization.html#showInDetailView">showInDetailView</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Table.html">Table</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Table.html#getContainer">getContainer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Table.html#getContainer">getContainer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Table.html#randomizeBlocked">randomizeBlocked</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Table.html#randomizeStartTarget">randomizeStartTarget</a></span></li><li class="nav-heading">Events</li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:comingfromchanged">comingfromchanged</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:displaychange">displaychange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:gchange">gchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:hchange">hchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:typechange">typechange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:xchange">xchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Cell.html#event:ychange">ychange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:addcell">addcell</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:canwalkdiagonalchange">canwalkdiagonalchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:heightchange">heightchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:removecell">removecell</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:resetpathfinding">resetpathfinding</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:startchange">startchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:steppingcostchange">steppingcostchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:targetchange">targetchange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Grid.html#event:widthchange">widthchange</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#floatToInt">floatToInt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getTypeOf">getTypeOf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#makeEventManager">makeEventManager</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#now">now</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">resources/scripts/pathfinder.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>window.addEventListener('DOMContentLoaded', function (e) {
    const pv = new PathfinderVisualization();
    document.body.appendChild(pv.wrapper);
});


{
    const template = `
    &lt;div class="container">&lt;/div>
    &lt;div class="meta">
        &lt;div class="cell-detail-column">
            &lt;div class="cell-detail">
                &lt;div class="head">
                    Cell (&lt;span class="cell-attr-x">&lt;/span>,&lt;span class="cell-attr-y">&lt;/span>)
                &lt;/div>
                &lt;div class="hr">&lt;/div>
                &lt;div class="body">
                    &lt;div>Typ:&lt;/div>
                    &lt;div class="cell-attr-type">&lt;/div>
                    &lt;div>H Wert:&lt;/div>
                    &lt;div class="cell-attr-hValue">&lt;/div>
                    &lt;div>G Wert:&lt;/div>
                    &lt;div class="cell-attr-gValue">&lt;/div>
                    &lt;div>F Wert:&lt;/div>
                    &lt;div class="cell-attr-fValue">&lt;/div>
                    &lt;div>Sichtbar:&lt;/div>
                    &lt;div class="cell-attr-display">&lt;/div>
                    &lt;div>Von:&lt;/div>
                    &lt;div class="cell-attr-comingFrom">&lt;/div>
                &lt;/div>
            &lt;/div>
        &lt;/div>
        &lt;div>
            &lt;div class="head">
                Steuerung
            &lt;/div>
            &lt;div class="hr">&lt;/div>
            &lt;div class="body">
                &lt;button class="step-button">Step&lt;/button>
                &lt;button class="reset-button">Reset&lt;/button>
                &lt;input type="checkbox" name="walk-diagonal" class="walk-diagonal">
                &lt;label for="walk-diagonal">Diagonal&lt;/label>
            &lt;/div>
        &lt;/div>
    &lt;/div>`

    const attr = ["type", "x", "y", "hValue", "gValue", "fValue", "display", "comingFrom"];

    /**
     * PathfinderVisualization combines {@link Table}, controls and interactivity.
     * @class
     */
    function PathfinderVisualization() {
        const wrapper = document.createElement('div');
        wrapper.className = 'wrapper';

        wrapper.innerHTML = template;

        const attrElemMap = {};
        const cellDetail = wrapper.getElementsByClassName('cell-detail-column')[0];

        Object.defineProperties(this, {
            /**
             *  
             * @member {Table} PathfinderVisualization#table
             */
            table: {
                value: new Table(60)
            },
            /**
             *  
             * @member {HTMLDivElement} PathfinderVisualization#wrapper
             */
            wrapper: {
                value: wrapper
            },
            /**
             *  
             * @member {HTMLDivElement} PathfinderVisualization#cellDetail
             */
            cellDetail: {
                value: cellDetail
            },
            /**
             *  
             * @member {Object} PathfinderVisualization#attrElemMap
             */
            attrElemMap: {
                value: attrElemMap
            },
            /**
             *  
             * @member {HTMLDivElement} PathfinderVisualization#highlighter
             */
            highlighter: {
                value: document.createElement('div')
            }
        });

        this.highlighter.className = "highlighter";

        /*
            Attribute binding for the cell detail view
        */

        for (let a of attr)
            attrElemMap[a] = this.cellDetail.getElementsByClassName('cell-attr-' + a)[0];

        attrElemMap.comingFrom.addEventListener('click', () => {
            const lc = attrElemMap.comingFrom.linkedCell;
            if (lc != undefined)
                this.showInDetailView(lc);
        });


        /*
            Alement appending
        */

        this.table.wrapper.appendChild(this.highlighter);
        this.wrapper.getElementsByClassName('container')[0].appendChild(this.table.wrapper);



        this.table.height = 14;
        this.table.width = 23;
        this.reset();

        /*
            Event binding
        */

        const showInDetailView = this.showInDetailView.bind(this);

        function cellClickListener(e) {
            if (e.ctrlKey) {
                table.grid.start = this.cell;
            } else {
                if (this.cell.type == 'blocked')
                    this.cell.type = 'traversable';
                else if (this.cell.type == 'traversable')
                    this.cell.type = 'blocked';
                else
                    showInDetailView(this.cell);
            }
        }

        function cellMouseOverListener(e) {
            if (this.cell.type == 'checked') {
                // console.log(this.cell.getPathOfCell());

            }
        }

        function cellMouseOutListener(e) {
            if (this.cell.type == 'checked') {
                // this.container.classList.remove('hovering');

            }
        }

        for (let x = 0; x &lt; this.table.grid.width; x++)
            for (let y = 0; y &lt; this.table.grid.height; y++) {

                let container = this.table.getContainer(x, y);
                let cell = this.table.grid.getCell(x, y);

                let binding = {
                    cell: cell,
                    container: container
                };

                console.log('binding on: ', cell);
                container.addEventListener('click', cellClickListener.bind(binding));
                container.addEventListener('mouseover', cellMouseOverListener.bind(binding));
                container.addEventListener('mouseout', cellMouseOutListener.bind(binding));
            }

        this.wrapper.getElementsByClassName('step-button')[0].addEventListener('click', () => {
            console.log('A* Step:', this.table.grid.step());
        });

        this.wrapper.getElementsByClassName('reset-button')[0].addEventListener('click', () => {
            this.reset();
        });

        const diagCheckbox = this.wrapper.getElementsByClassName('walk-diagonal')[0];
        this.table.grid.canWalkDiagonal = diagCheckbox.checked;

        diagCheckbox.addEventListener('click', () => {
            this.table.grid.canWalkDiagonal = diagCheckbox.checked;
        })
    }

    /**
     * Resets the ui and the {@link Table} which also resets the {@link Grid} 
     */
    PathfinderVisualization.prototype.reset = function reset() {
        this.cellDetail.setAttribute('data-visible', 'false');
        this.highlighter.setAttribute('data-visible', 'false');

        this.table.grid.resetPathfinding();
        this.table.randomizeBlocked();
        this.table.randomizeStartTarget();
    }

    /**
     * Shows given cell in the detail view and points the highlighter on it.
     * 
     * @param {Cell?} cell if undefined is transmitted the detail view and the highlighter will be gone
     */
    PathfinderVisualization.prototype.showInDetailView = function showInDetailView(cell) {
        if (cell == undefined) {
            this.cellDetail.setAttribute('data-visible', 'false');
            this.highlighter.setAttribute('data-visible', 'false');
            return;
        } else {
            this.cellDetail.setAttribute('data-visible', 'true');
            this.highlighter.setAttribute('data-visible', 'true');

            let elem = this.table.getContainer(cell.x, cell.y);
            const offset = (this.table.highlighterWidth - this.table.cellWidth) / 2;
            this.highlighter.style.setProperty('top', (+elem.style.getPropertyValue('top').slice(0, -2) - offset) + 'px');
            this.highlighter.style.setProperty('left', (+elem.style.getPropertyValue('left').slice(0, -2) - offset) + 'px');

            for (let a of attr) {
                if (this.attrElemMap[a] == undefined)
                    continue;

                if (a == 'comingFrom') {
                    let cf = cell.comingFrom,
                        cfe = this.attrElemMap.comingFrom;

                    cfe.linkedCell = cf;
                    cfe.innerText = cf == undefined ? '&lt;undefined>' : 'Cell (' + cf.x + ',' + cf.y + ')';
                } else {
                    this.attrElemMap[a].innerText = typeof cell[a] == 'number' ? Math.round10(cell[a], -2) : cell[a];
                }
            }
        }
    }
}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Mar 25 2018 21:36:51 GMT+0200 (Mitteleuropäische Sommerzeit) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
